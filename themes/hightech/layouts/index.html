{{ define "main" }}
  <!-- Slider -->
<div id="slider" class="relative overflow-hidden rounded-lg shadow">
  {{ $slides := .Site.Params.slider }}
  {{ $menus := .Site.Menus.main }}
  
  {{ range $i, $menu := $menus }}
    <div class="slide {{ if ne $i 0 }}hidden{{ end }}" data-menu="{{ $menu.Identifier }}">
      <img src="/images/{{ $menu.Identifier }}.png" alt="{{ $menu.Identifier }}" class="w-full h-64 object-cover">
    </div>
  {{ end }}
</div>

  <!-- Zone centrale pour derniers articles / sous-menus -->
  <section id="main-content">
    <h2 class="text-xl font-bold mb-4">Derniers articles</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      {{ range first 9 (where .Site.RegularPages "Type" "in" (slice "smartphones" "tablettes" "ordinateurs" "photos-videos" "wearables" "televisions" "gaming" "domotique" "audio" "objets-connectes" "impression" "peripheriques" )) }}
        <article class="bg-white rounded shadow overflow-hidden">
          {{ with .Params.thumbnail }}
            <img src="{{ . }}" alt="{{ $.Title }}" class="w-full h-40 object-cover">
          {{ else }}
            <img src="/images/placeholder.jpg" alt="thumb" class="w-full h-40 object-cover">
          {{ end }}
          <div class="p-4">
            <h3 class="font-semibold text-lg"><a href="{{ .RelPermalink }}">{{ .Title }}</a></h3>
            <p class="text-sm text-gray-600 mt-2">{{ .Summary }}</p>
          </div>
        </article>
      {{ end }}
    </div>
  </section>

  <!-- Slider JS -->

<script>
  const intervalTime = {{ default 3000 .Site.Params.sliderInterval }};
  let currentIndex = 0;
  let sliderInterval;
  const slider = document.getElementById('slider');
  const defaultSlides = Array.from(slider.querySelectorAll('.slide'));

  function showSlide(index) {
    defaultSlides.forEach((slide, i) => {
      slide.classList.toggle('hidden', i !== index);
    });
    currentIndex = index;
  }

  function startSlider() {
    if (!defaultSlides.length) return;
    sliderInterval = setInterval(() => {
      const nextIndex = (currentIndex + 1) % defaultSlides.length;
      showSlide(nextIndex);
    }, intervalTime);
  }

  function stopSlider() {
    clearInterval(sliderInterval);
  }

  // DÃ©marrage automatique
  startSlider();

  // Expose pour menu.js
  window.startSlider = startSlider;
  window.stopSlider = stopSlider;
  window.showSlideByMenuId = (menuId, imgSrc) => {
    stopSlider();
    slider.innerHTML = `<div class="slide"><img src="${imgSrc}" alt="${menuId}" class="w-full h-64 object-cover"></div>`;
  };
</script>



{{ end }}
