<head>

<script>
/*
  Fix temporaire : si l'URL contient explicitement /fr/ ou /en/ ou /ar/,
  on sauvegarde ce choix dans localStorage *avant* que d'autres scripts ne tournent.
  Ainsi les scripts de redirection qui lisent preferredLang respecteront l'URL explicite.
*/
(function(){
  try {
    var m = location.pathname.toLowerCase().match(/^\/(fr|en|ar)(\/|$)/);
    if (m && m[1]) {
      localStorage.setItem('preferredLang', m[1]); // 'fr'|'en'|'ar'
      // optionnel : log pour debug
      console && console.log('[lang-lock] preferredLang set to', m[1]);
    }
  } catch (e) {
    console && console.warn('[lang-lock] error', e);
  }
})();
</script>


  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Titre du site -->
  <title>{{ if .Title }}{{ .Title }} - {{ end }}{{ .Site.Title }}</title>
  
  <!-- Description SEO -->
  <meta name="description" content="{{ .Site.Params.description }}">
  <link rel="icon" type="image/png" href="{{ "favicon_2.png" | absURL }}">

  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

     <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
     <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap" rel="stylesheet">
 <!--    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">   -->
 <!--    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&display=swap" rel="stylesheet">   -->
     <!-- Styles personnalisés -->
     <style>
     body { font-family: 'Inter', sans-serif; }
     /* small helpers */
     .main-color { --tw-bg-opacity:1; background-color: theme(colors.emerald.400); }
     </style>

     <!-- Sélection de la langue du site -->


  <!-- ---------------------------------------------------------
       MÉTA-DONNÉES DE BASE + TITRE
       --------------------------------------------------------- -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <!-- Title : PageTitle — SiteTitle -->
  <title>{{ if .Title }}{{ .Title }} — {{ end }}{{ .Site.Title }}</title>

  <!-- Description SEO -->
  <meta name="description" content="{{ .Site.Params.description }}">

  <!-- ---------------------------------------------------------
       URL CANONIQUE (IMPORTANT POUR LE SEO)
       --------------------------------------------------------- -->
  <link rel="canonical" href="{{ .Permalink }}">

  <!-- ---------------------------------------------------------
       OPEN GRAPH : aperçu partage réseaux sociaux
       --------------------------------------------------------- -->
  <meta property="og:title" content="{{ if .Title }}{{ .Title }} — {{ end }}{{ .Site.Title }}">
  <meta property="og:description" content="{{ .Site.Params.description }}">
  <meta property="og:type" content="{{ if .IsPage }}article{{ else }}website{{ end }}">
  <meta property="og:url" content="{{ .Permalink }}">
  <!-- Option image OG (si tu veux ajouter plus tard) -->
  <!-- <meta property="og:image" content="{{ .Site.BaseURL }}images/og-default.jpg"> -->

  <!-- ---------------------------------------------------------
       TWITTER CARDS
       --------------------------------------------------------- -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="{{ if .Title }}{{ .Title }} — {{ end }}{{ .Site.Title }}">
  <meta name="twitter:description" content="{{ .Site.Params.description }}">
  <!-- <meta name="twitter:image" content="{{ .Site.BaseURL }}images/og-default.jpg"> -->

  <!-- ---------------------------------------------------------
       POLICES GOOGLE FONTS
       ---------------------------------------------------------
       Optimisation performances :
       - Preconnect = prépare la connexion
       - Preload = charge la police en avance, amélioration du LCP
       --------------------------------------------------------- -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <!-- Preload fonts -->
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Inter:wght@400;600;700&display=swap" as="style">

  <!-- Fallback stylesheet link -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- ---------------------------------------------------------
       CSS DU SITE
       --------------------------------------------------------- -->
  <link rel="stylesheet" href="{{ "css/main.css" | relURL }}">
  <link rel="stylesheet" href="{{ "css/style.css" | relURL }}">
  <link rel="stylesheet" href="{{ "css/custom.css" | relURL }}">

<!-- Javascript pour la détection de la lnague du navigateur pour afficher la bonne version du site -->

<script>
/*
  Lang-redirect pour site statique Hugo (fonctionne côté client, indépendant de Cloudflare).
  Règles :
   - Si l'URL commence déjà par /fr/ ou /en/ ou /ar/ -> ne rien faire (respecter l'URL explicite).
   - Si l'utilisateur a enregistré un choix (localStorage 'preferredLang') -> respecter.
   - Sinon, détecter la langue du navigateur :
       * si commence par "ar" -> /ar/
       * else if commence par "fr" -> /fr/
       * else -> /en/
   - Ne rediriger que quand on est sur la racine ("/" ou "/index.html").
   - Préserve querystring et hash.
*/

(function() {
  try {
    const supported = ['fr','en','ar'];
    const path = window.location.pathname || '/';
    const normPath = path.toLowerCase();

    // Si l'URL commence par une langue supportée (/fr/ /en/ /ar/ ou /fr /en /ar sans slash final)
    const langPrefixMatch = normPath.match(/^\/(fr|en|ar)(\/|$)/);
    if (langPrefixMatch) {
      // URL explicite : on respecte la langue dans l'URL — pas de redirection.
      return;
    }

    // On ne redirige que si on est sur la racine ("/" ou "/index.html")
    if (!(normPath === '/' || normPath === '/index.html')) {
      return;
    }

    // 1) vérifier si l'utilisateur a un choix enregistré (par ex. via le sélecteur de langue)
    const persisted = localStorage.getItem('preferredLang');
    if (persisted && supported.includes(persisted)) {
      const dest = '/' + persisted + '/';
      if (window.location.pathname !== dest) {
        window.location.replace( dest + window.location.search + window.location.hash );
      }
      return;
    }

    // 2) détecter la langue du navigateur (utilise navigator.languages si disponible)
    const navs = navigator.languages && navigator.languages.length ? navigator.languages : [navigator.language || navigator.userLanguage || ''];
    const pickLang = (() => {
      for (let l of navs) {
        if (!l) continue;
        l = l.toLowerCase();
        if (l.startsWith('ar')) return 'ar';
        if (l.startsWith('fr')) return 'fr';
      }
      return 'en';
    })();

    const destination = '/' + pickLang + '/';
    // si déjà sur la destination => nothing
    if (window.location.pathname !== destination) {
      // use replace() to avoid polluting history
      window.location.replace( destination + window.location.search + window.location.hash );
    }
  } catch (e) {
    // en cas d'erreur on ne fait rien (évite blocage total)
    console.error('lang redirect error', e);
  }
})();
</script>

  
</head>